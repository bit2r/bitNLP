library(dplyr)

buzz$CONTENT[1:10]


#' @import dplyr
#' @importFrom rlang 
#' @importFrom stringr str_squish
collocation <- function(doc, term, token = c("ngrams", "noun_ngrams"), n = 2,
                        stopwords = character(), indiv = FALSE) {
  token <- rlang::arg_match(token)
  
  doc %>% 
    stringr::str_squish() %>%    
    stringr::str_remove_all("[0-9]") %>% 
    as_tibble() %>%
    mutate(doc_id = row_number()) %>% 
    tidytext::unnest_tokens(ngrams, value, token = token, n = n, 
                            stopwords = stopwords) %>% 
    group_by(ngrams) %>% 
    tally() %>% 
    rename("frequency" = n) %>% 
    arrange(desc(frequency))
}

collocation(buzz$CONTENT[1:20], "맞벌이")
collocation(buzz$CONTENT[1:20], "맞벌이", token = "noun_ngrams",
            stopwords = c("월"))


examplefcm <-
  tokens(buzz$CONTENT[1:20], remove_punct = TRUE) %>%
  tokens_remove(stopwords("english"), padding = FALSE) %>%
  fcm(context = "window", window = 5, tri = FALSE)

buzz$CONTENT[1:20] %>% 
  stringr::str_squish() %>%    
  stringr::str_remove_all("[0-9]") %>% 
  morpho_mecab(indiv = FALSE) %>% 
  fcm(context = "window", window = 5, tri = FALSE)
